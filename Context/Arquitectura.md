# üèóÔ∏è ARQUITECTURA DE PODENZA

## Informaci√≥n General
**PODENZA** es una plataforma **SaaS multi-tenancy** de gesti√≥n de solicitudes de cr√©dito construida sobre el stack **Next.js + Supabase**, implementando un sistema modular con arquitectura de monorepo usando Turborepo. **Optimizada para soportar +1000 transacciones por hora** con performance cr√≠tico entre Vercel, Next.js y Supabase.

---

## üìä STACK TECNOL√ìGICO

### **Frontend Framework**
- **Next.js 15.1.7** - App Router, React Server Components, Edge Runtime
- **React 19.0.0** - Biblioteca UI principal con Server Components
- **TypeScript 5.7.3** - Tipado est√°tico estricto

### **UI/UX System**
- **Tailwind CSS 4.0.6** - Framework CSS utility-first
- **Shadcn UI** - Sistema de componentes basado en Radix UI
- **Radix UI** - Componentes primitivos accesibles
- **Lucide React** - Iconograf√≠a consistente
- **Sonner** - Sistema de notificaciones toast

### **Backend & Base de Datos**
- **Supabase** - Backend as a Service (Multi-Tenant Architecture)
  - PostgreSQL 15+ con extensiones optimizadas
  - **Row Level Security (RLS)** multi-tenant
  - **Particionado de tablas** para performance
  - **√çndices optimizados** para +1000 transacciones/hora
  - Real-time subscriptions
  - Edge Functions (Deno)
  - Storage para archivos
- **Autenticaci√≥n integrada** - JWT + RLS policies + Tenant isolation

### **Estado y Gesti√≥n de Datos**
- **TanStack Query 5.64.1** - Server state management
- **React Hook Form 7.54.2** - Gesti√≥n de formularios
- **Zod 3.24.2** - Validaci√≥n de schemas
- **React i18next 15.4.0** - Internacionalizaci√≥n

---

## üóÇÔ∏è ESTRUCTURA DEL PROYECTO

### **Monorepo Architecture**
```
PODENZA/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                    # Next.js App Principal
‚îÇ   ‚îî‚îÄ‚îÄ e2e/                    # Tests Playwright
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ features/               # M√≥dulos de Funcionalidad
‚îÇ   ‚îú‚îÄ‚îÄ ui/                     # Sistema de Componentes
‚îÇ   ‚îú‚îÄ‚îÄ supabase/              # Cliente DB
‚îÇ   ‚îú‚îÄ‚îÄ auth/                  # Autenticaci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ shared/                # Utilidades Compartidas
‚îú‚îÄ‚îÄ tooling/                   # Configuraciones
‚îî‚îÄ‚îÄ Context/                   # Documentaci√≥n T√©cnica
```

### **Frontend Structure (apps/web/)**
```
app/
‚îú‚îÄ‚îÄ (marketing)/               # P√°ginas p√∫blicas
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              # Landing page
‚îÇ   ‚îî‚îÄ‚îÄ about/                # Informaci√≥n corporativa
‚îú‚îÄ‚îÄ auth/                     # Flow de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ sign-in/
‚îÇ   ‚îú‚îÄ‚îÄ sign-up/
‚îÇ   ‚îî‚îÄ‚îÄ password-reset/
‚îú‚îÄ‚îÄ home/                     # √Årea protegida
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx             # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ settings/            # Configuraci√≥n usuario
‚îÇ   ‚îî‚îÄ‚îÄ solicitudes/         # M√≥dulo de solicitudes
‚îî‚îÄ‚îÄ globals.css              # Estilos globales
```

---

## üîê ARQUITECTURA DE SEGURIDAD

### **Autenticaci√≥n (Supabase Auth)**
- **JWT Tokens** - Manejo autom√°tico de tokens
- **Multi-provider** - Email/Password (habilitado)
- **Session Management** - Refresh autom√°tico
- **MFA Ready** - Configuraci√≥n para 2FA

### **Autorizaci√≥n (Row Level Security)**
```sql
-- Pol√≠tica ejemplo para accounts
CREATE POLICY "Users can read own account" ON accounts
    FOR SELECT USING (auth.uid() = created_by);

CREATE POLICY "Users can update own account" ON accounts
    FOR UPDATE USING (auth.uid() = created_by);
```

### **Seguridad de Datos**
- **RLS habilitado** en todas las tablas cr√≠ticas
- **Triggers** para auditor√≠a autom√°tica
- **Validaci√≥n** en frontend y backend (Zod schemas)
- **Sanitizaci√≥n** de inputs y uploads

---

## üóÑÔ∏è ARQUITECTURA DE BASE DE DATOS - MULTI-TENANT

### **üè¢ DISE√ëO SAAS MULTI-TENANCY**

PODENZA implementa un **modelo de tenant isolation a nivel de Row Level Security (RLS)** optimizado para **+1000 transacciones por hora** con las siguientes caracter√≠sticas:

#### **Modelo de Tenancy**
- **Shared Database, Shared Schema** con isolation por `organization_id`
- **Row Level Security (RLS)** para complete tenant isolation
- **Particionado de tablas** por tenant para performance √≥ptimo
- **√çndices compuestos** optimizados para queries multi-tenant

#### **Schema Multi-Tenant Optimizado**
```sql
-- 1. TABLA DE ORGANIZACIONES (TENANTS)
organizations (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    name varchar(255) NOT NULL,
    slug varchar(100) NOT NULL UNIQUE,           -- Para tenant identification
    plan_type varchar(50) DEFAULT 'basic',       -- basic, premium, enterprise
    max_users integer DEFAULT 10,
    max_solicitudes integer DEFAULT 100,
    settings jsonb DEFAULT '{}',
    created_at timestamptz DEFAULT NOW(),
    updated_at timestamptz DEFAULT NOW(),
    is_active boolean DEFAULT true
);

-- √çndices cr√≠ticos para performance
CREATE INDEX CONCURRENTLY idx_organizations_slug ON organizations (slug);
CREATE INDEX CONCURRENTLY idx_organizations_active ON organizations (is_active) WHERE is_active = true;

-- 2. ACCOUNTS EXTENDIDO PARA MULTI-TENANCY
accounts (
    id uuid PRIMARY KEY,
    organization_id uuid REFERENCES organizations(id) ON DELETE CASCADE,
    name varchar(255) NOT NULL,
    email varchar(320) NOT NULL,
    role varchar(50) DEFAULT 'user',              -- admin, user, viewer
    picture_url varchar(1000),
    public_data jsonb DEFAULT '{}',
    tenant_permissions jsonb DEFAULT '{}',
    is_active boolean DEFAULT true,
    last_login_at timestamptz,
    created_at timestamptz DEFAULT NOW(),
    updated_at timestamptz DEFAULT NOW(),
    created_by uuid REFERENCES auth.users,
    updated_by uuid REFERENCES auth.users,

    -- Constraint: email √∫nico por organizaci√≥n
    UNIQUE(organization_id, email)
);

-- √çndices optimizados para multi-tenant queries
CREATE INDEX CONCURRENTLY idx_accounts_org_active ON accounts (organization_id, is_active) WHERE is_active = true;
CREATE INDEX CONCURRENTLY idx_accounts_org_role ON accounts (organization_id, role);

-- 3. SOLICITUDES PARTICIONADA (CORE BUSINESS)
solicitudes (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    numero_solicitud varchar(50) NOT NULL,       -- SOL-2024-001
    cedula varchar(20) NOT NULL,
    cliente varchar(255) NOT NULL,
    asesor_id uuid REFERENCES accounts(id),
    asesor_name varchar(255) NOT NULL,
    afiliado boolean DEFAULT false,
    vitrina varchar(100),
    banco varchar(100),
    monto decimal(15,2) NOT NULL,
    producto varchar(100) NOT NULL,
    estado varchar(50) DEFAULT 'viabilidad',
    fecha_solicitud date DEFAULT CURRENT_DATE,
    metadata jsonb DEFAULT '{}',
    search_vector tsvector,                       -- Full-text search optimizado
    created_at timestamptz DEFAULT NOW(),
    updated_at timestamptz DEFAULT NOW(),
    created_by uuid REFERENCES accounts(id),
    updated_by uuid REFERENCES accounts(id),

    -- Constraint: n√∫mero √∫nico por organizaci√≥n
    UNIQUE(organization_id, numero_solicitud)
) PARTITION BY HASH (organization_id);

-- Crear particiones para performance (4 particiones iniciales)
CREATE TABLE solicitudes_part_0 PARTITION OF solicitudes FOR VALUES WITH (modulus 4, remainder 0);
CREATE TABLE solicitudes_part_1 PARTITION OF solicitudes FOR VALUES WITH (modulus 4, remainder 1);
CREATE TABLE solicitudes_part_2 PARTITION OF solicitudes FOR VALUES WITH (modulus 4, remainder 2);
CREATE TABLE solicitudes_part_3 PARTITION OF solicitudes FOR VALUES WITH (modulus 4, remainder 3);

-- 4. DOCUMENTOS
documentos (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    solicitud_id uuid REFERENCES solicitudes(id) ON DELETE CASCADE,
    nombre varchar(255) NOT NULL,
    tipo varchar(50) NOT NULL,                    -- cedula, ingresos, inmueble, auco
    archivo_url varchar(1000) NOT NULL,
    mime_type varchar(100),
    tama√±o_bytes bigint,
    version integer DEFAULT 1,
    es_version_actual boolean DEFAULT true,
    metadata jsonb DEFAULT '{}',
    estado_validacion varchar(50) DEFAULT 'pendiente',
    created_at timestamptz DEFAULT NOW(),
    created_by uuid REFERENCES accounts(id)
);

-- 5. AUDIT TRAIL PARTICIONADO POR FECHA
audit_logs (
    id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    table_name varchar(100) NOT NULL,
    record_id uuid NOT NULL,
    action varchar(20) NOT NULL,                  -- INSERT, UPDATE, DELETE
    old_values jsonb,
    new_values jsonb,
    user_id uuid REFERENCES accounts(id),
    user_email varchar(320),
    ip_address inet,
    user_agent text,
    created_at timestamptz DEFAULT NOW()
) PARTITION BY RANGE (created_at);
```

### **üöÄ √çNDICES CR√çTICOS PARA PERFORMANCE**

#### **√çndices Multi-Tenant Optimizados**
```sql
-- Solicitudes: √çndices cr√≠ticos para +1000 transacciones/hora
CREATE INDEX CONCURRENTLY idx_solicitudes_org_estado ON solicitudes (organization_id, estado);
CREATE INDEX CONCURRENTLY idx_solicitudes_org_fecha ON solicitudes (organization_id, fecha_solicitud DESC);
CREATE INDEX CONCURRENTLY idx_solicitudes_org_asesor ON solicitudes (organization_id, asesor_id);
CREATE INDEX CONCURRENTLY idx_solicitudes_cedula_org ON solicitudes (organization_id, cedula);
CREATE INDEX CONCURRENTLY idx_solicitudes_search ON solicitudes USING GIN (search_vector);

-- √çndice parcial para solicitudes activas (queries m√°s frecuentes)
CREATE INDEX CONCURRENTLY idx_solicitudes_org_activas
ON solicitudes (organization_id, estado, fecha_solicitud DESC)
WHERE estado IN ('viabilidad', 'viable', 'pre_aprobado', 'en_estudio');

-- Documentos: Performance para upload/retrieval
CREATE INDEX CONCURRENTLY idx_documentos_org_solicitud ON documentos (organization_id, solicitud_id);
CREATE INDEX CONCURRENTLY idx_documentos_org_tipo ON documentos (organization_id, tipo);
```

### **üîí RLS POLICIES MULTI-TENANT**

#### **Tenant Isolation Completo**
```sql
-- Organizations: Solo usuarios de la organizaci√≥n
CREATE POLICY "Users can access their organization" ON organizations
    FOR ALL TO authenticated
    USING (
        id IN (
            SELECT organization_id
            FROM accounts
            WHERE id = auth.uid() AND is_active = true
        )
    );

-- Solicitudes: RLS optimizado por organizaci√≥n
CREATE POLICY "Users can access solicitudes from their org" ON solicitudes
    FOR ALL TO authenticated
    USING (
        organization_id IN (
            SELECT organization_id
            FROM accounts
            WHERE id = auth.uid() AND is_active = true
        )
    );
```

### **‚ö° FUNCIONES OPTIMIZADAS PARA PERFORMANCE**

#### **Estad√≠sticas Agregadas (Cached)**
```sql
-- Funci√≥n optimizada para dashboard stats
CREATE OR REPLACE FUNCTION get_solicitudes_stats(org_id UUID)
RETURNS JSON AS $$
DECLARE
    stats JSON;
BEGIN
    SELECT json_build_object(
        'total', COUNT(*),
        'viabilidad', COUNT(*) FILTER (WHERE estado = 'viabilidad'),
        'viable', COUNT(*) FILTER (WHERE estado = 'viable'),
        'pre_aprobado', COUNT(*) FILTER (WHERE estado = 'pre_aprobado'),
        'aprobado', COUNT(*) FILTER (WHERE estado = 'aprobado')
    ) INTO stats
    FROM solicitudes
    WHERE organization_id = org_id;

    RETURN stats;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- B√∫squeda Full-Text optimizada
CREATE OR REPLACE FUNCTION search_solicitudes(
    org_id UUID,
    search_term TEXT DEFAULT '',
    estado_filter TEXT DEFAULT '',
    limit_results INTEGER DEFAULT 50
)
RETURNS TABLE (...) AS $$
-- Implementaci√≥n optimizada con √≠ndices GIN
$$;
```

### **üìä EXTENSIONES HABILITADAS**
```sql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";     -- UUID generation
CREATE EXTENSION IF NOT EXISTS "unaccent";      -- Text search sin acentos
CREATE EXTENSION IF NOT EXISTS "pg_trgm";       -- Fuzzy text search
CREATE EXTENSION IF NOT EXISTS "btree_gin";     -- √çndices GIN compuestos
```

### **Storage Architecture**
```
Storage Buckets:
‚îú‚îÄ‚îÄ profile-pictures/          # Im√°genes de perfil
‚îú‚îÄ‚îÄ documents/                 # Documentos de solicitudes
‚îî‚îÄ‚îÄ uploads/                   # Archivos temporales
```

---

## üöÄ ARQUITECTURA DE DEPLOYMENT

### **Vercel Configuration**
- **Framework Preset**: Next.js
- **Node Version**: 18+
- **Build Command**: `turbo build`
- **Edge Runtime**: Habilitado para API routes
- **Serverless Functions**: Auto-scaling

### **Environment Variables**
```bash
# App Configuration
NEXT_PUBLIC_SITE_URL=https://podenza.vercel.app
NEXT_PUBLIC_PRODUCT_NAME=PODENZA
NEXT_PUBLIC_THEME_COLOR=#E7FF8C

# Supabase Integration
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role
```

---

## üîå ARQUITECTURA DE INTEGRACIONES

### **Integraciones Implementadas**
- ‚úÖ **Supabase** - Base de datos y autenticaci√≥n
- ‚úÖ **Vercel** - Hosting y CI/CD
- ‚úÖ **Cloudflare** - Edge runtime support

### **Integraciones Planificadas**

#### **Email Service**
- **Sendgrid** - Transactional emails
- **Resend** - Alternative email provider
```typescript
// packages/email/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ sendgrid.ts
‚îÇ   ‚îî‚îÄ‚îÄ resend.ts
‚îî‚îÄ‚îÄ templates/
    ‚îú‚îÄ‚îÄ welcome.tsx
    ‚îî‚îÄ‚îÄ password-reset.tsx
```

#### **WhatsApp Integration**
- **WhatsApp Business API** - Notificaciones
- **Webhook handling** - Messages y status updates
```typescript
// packages/whatsapp/
‚îú‚îÄ‚îÄ api.ts              # WhatsApp API client
‚îú‚îÄ‚îÄ webhook.ts          # Webhook handlers
‚îî‚îÄ‚îÄ templates/          # Message templates
```

#### **AUCO Integration**
- **API Client** - Consultas a AUCO
- **Webhook receiver** - Updates de status
```typescript
// packages/auco/
‚îú‚îÄ‚îÄ client.ts           # AUCO API client
‚îú‚îÄ‚îÄ types.ts            # Response types
‚îî‚îÄ‚îÄ webhook.ts          # Status updates
```

#### **Banking APIs**
- **Bancolombia**
- **Davivienda**
- **BBVA**
- **Banco de Bogot√°**
```typescript
// packages/banking/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ bancolombia.ts
‚îÇ   ‚îú‚îÄ‚îÄ davivienda.ts
‚îÇ   ‚îî‚îÄ‚îÄ bbva.ts
‚îî‚îÄ‚îÄ types/
    ‚îú‚îÄ‚îÄ responses.ts
    ‚îî‚îÄ‚îÄ requests.ts
```

---

## ü§ñ ARQUITECTURA DE AI

### **AI Services Integration**
```typescript
// packages/ai/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ openai.ts          # OpenAI GPT-4
‚îÇ   ‚îú‚îÄ‚îÄ anthropic.ts       # Claude
‚îÇ   ‚îî‚îÄ‚îÄ gemini.ts          # Google Gemini
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ document-analysis.ts
‚îÇ   ‚îú‚îÄ‚îÄ risk-assessment.ts
‚îÇ   ‚îî‚îÄ‚îÄ decision-engine.ts
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ ai-responses.ts
```

### **Document Processing**
- **OCR** - Extracci√≥n de texto de documentos
- **NLP** - An√°lisis de contenido
- **ML Models** - Scoring crediticio

---

## üìä ARQUITECTURA DE ANALYTICS & BI

### **Business Intelligence**
```typescript
// packages/analytics/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ google-analytics.ts
‚îÇ   ‚îú‚îÄ‚îÄ mixpanel.ts
‚îÇ   ‚îî‚îÄ‚îÄ posthog.ts
‚îú‚îÄ‚îÄ dashboards/
‚îÇ   ‚îú‚îÄ‚îÄ executive.ts
‚îÇ   ‚îú‚îÄ‚îÄ operations.ts
‚îÇ   ‚îî‚îÄ‚îÄ credit-risk.ts
‚îî‚îÄ‚îÄ reports/
    ‚îú‚îÄ‚îÄ monthly.ts
    ‚îî‚îÄ‚îÄ real-time.ts
```

### **Data Warehouse**
- **Supabase Analytics** - Query analytics
- **BigQuery** - Data warehouse
- **Metabase** - BI dashboards

---

## üîÑ ARQUITECTURA DE AUTOMATIZACI√ìN

### **Workflow Engine**
```typescript
// packages/automation/
‚îú‚îÄ‚îÄ engines/
‚îÇ   ‚îú‚îÄ‚îÄ credit-workflow.ts
‚îÇ   ‚îú‚îÄ‚îÄ document-workflow.ts
‚îÇ   ‚îî‚îÄ‚îÄ notification-workflow.ts
‚îú‚îÄ‚îÄ triggers/
‚îÇ   ‚îú‚îÄ‚îÄ time-based.ts
‚îÇ   ‚îú‚îÄ‚îÄ event-based.ts
‚îÇ   ‚îî‚îÄ‚îÄ condition-based.ts
‚îî‚îÄ‚îÄ actions/
    ‚îú‚îÄ‚îÄ email.ts
    ‚îú‚îÄ‚îÄ sms.ts
    ‚îî‚îÄ‚îÄ api-calls.ts
```

### **Decision Engine**
```typescript
// packages/decision-engine/
‚îú‚îÄ‚îÄ rules/
‚îÇ   ‚îú‚îÄ‚îÄ credit-scoring.ts
‚îÇ   ‚îú‚îÄ‚îÄ risk-assessment.ts
‚îÇ   ‚îî‚îÄ‚îÄ approval-matrix.ts
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ ml-model.ts
‚îÇ   ‚îî‚îÄ‚îÄ rule-engine.ts
‚îî‚îÄ‚îÄ api/
    ‚îî‚îÄ‚îÄ decision-api.ts
```

---

## üìÅ ARQUITECTURA DE STORAGE

### **File Management**
```typescript
// packages/storage/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ supabase-storage.ts
‚îÇ   ‚îú‚îÄ‚îÄ aws-s3.ts
‚îÇ   ‚îî‚îÄ‚îÄ cloudinary.ts
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ compression.ts
‚îÇ   ‚îú‚îÄ‚îÄ virus-scan.ts
‚îÇ   ‚îî‚îÄ‚îÄ metadata-extraction.ts
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ file-types.ts
```

### **Document Processing**
- **Compression** - Optimizaci√≥n de archivos
- **Virus Scanning** - Seguridad de uploads
- **Metadata Extraction** - Informaci√≥n de documentos
- **Versioning** - Control de versiones

---

## üåê ARQUITECTURA DE APIs

### **Internal APIs**
```typescript
// apps/web/app/api/
‚îú‚îÄ‚îÄ auth/                 # Autenticaci√≥n endpoints
‚îú‚îÄ‚îÄ accounts/             # Gesti√≥n de cuentas
‚îú‚îÄ‚îÄ solicitudes/          # CRUD solicitudes
‚îú‚îÄ‚îÄ webhooks/             # External webhooks
‚îÇ   ‚îú‚îÄ‚îÄ auco/
‚îÇ   ‚îú‚îÄ‚îÄ banks/
‚îÇ   ‚îî‚îÄ‚îÄ whatsapp/
‚îî‚îÄ‚îÄ integrations/         # External API calls
    ‚îú‚îÄ‚îÄ banking/
    ‚îú‚îÄ‚îÄ email/
    ‚îî‚îÄ‚îÄ ai/
```

### **External APIs (Exposici√≥n)**
```typescript
// API p√∫blica para terceros
/api/v1/
‚îú‚îÄ‚îÄ auth/                 # API authentication
‚îú‚îÄ‚îÄ solicitudes/          # Credit applications
‚îÇ   ‚îú‚îÄ‚îÄ GET /             # List applications
‚îÇ   ‚îú‚îÄ‚îÄ POST /            # Create application
‚îÇ   ‚îú‚îÄ‚îÄ GET /:id          # Get application
‚îÇ   ‚îî‚îÄ‚îÄ PUT /:id          # Update application
‚îú‚îÄ‚îÄ webhooks/             # Webhook endpoints
‚îî‚îÄ‚îÄ status/               # Health checks
```

---

## üîç ARQUITECTURA DE MONITORING

### **Application Monitoring**
```typescript
// packages/monitoring/
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ sentry.ts         # Error tracking
‚îÇ   ‚îú‚îÄ‚îÄ datadog.ts        # APM
‚îÇ   ‚îî‚îÄ‚îÄ newrelic.ts       # Performance
‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îú‚îÄ‚îÄ performance.ts
‚îÇ   ‚îú‚îÄ‚îÄ errors.ts
‚îÇ   ‚îî‚îÄ‚îÄ business.ts
‚îî‚îÄ‚îÄ alerts/
    ‚îú‚îÄ‚îÄ error-alerts.ts
    ‚îî‚îÄ‚îÄ performance-alerts.ts
```

### **Health Checks**
- **Database connectivity**
- **External API status**
- **Service dependencies**
- **Performance metrics**

---

## üîÑ ARQUITECTURA DE CI/CD

### **GitHub Actions**
```yaml
# .github/workflows/
‚îú‚îÄ‚îÄ ci.yml                # Continuous Integration
‚îú‚îÄ‚îÄ cd.yml                # Continuous Deployment
‚îú‚îÄ‚îÄ security.yml          # Security scans
‚îî‚îÄ‚îÄ performance.yml       # Performance tests
```

### **Deployment Pipeline**
1. **Code Push** ‚Üí GitHub
2. **CI Checks** ‚Üí Tests, Linting, Type checking
3. **Security Scan** ‚Üí Dependency audit, SAST
4. **Build** ‚Üí Turborepo build
5. **Deploy** ‚Üí Vercel deployment
6. **Smoke Tests** ‚Üí Post-deployment validation

---

## üìö PATTERNS & CONVENTIONS

### **Code Organization**
- **Monorepo** - Turborepo para gesti√≥n de packages
- **Atomic Design** - Componentes organizados por complejidad
- **Feature-based** - M√≥dulos por funcionalidad de negocio
- **Type-safe** - TypeScript estricto en todo el stack

### **API Design**
- **RESTful** - Endpoints siguiendo convenciones REST
- **Type-safe** - Zod schemas para validaci√≥n
- **Error Handling** - C√≥digos de error consistentes
- **Rate Limiting** - Protecci√≥n contra abuso

### **Database Design**
- **Normalized** - Estructura relacional optimizada
- **Audit Trail** - Tracking de cambios autom√°tico
- **Soft Deletes** - Preservaci√≥n de datos hist√≥ricos
- **Indexing** - Optimizaci√≥n de queries frecuentes

---

## üöÄ ESCALABILIDAD

### **Performance Optimizations**
- **Static Generation** - Pages est√°ticas donde sea posible
- **Server Components** - Renderizado en servidor
- **Image Optimization** - Next.js Image component
- **Bundle Optimization** - Tree shaking y code splitting

### **Database Scaling**
- **Read Replicas** - Distribuci√≥n de carga de lectura
- **Connection Pooling** - Optimizaci√≥n de conexiones
- **Query Optimization** - Indexes y query planning
- **Caching** - Redis para datos frecuentes

### **Infrastructure Scaling**
- **Edge Computing** - Cloudflare/Vercel Edge
- **CDN** - Assets distribuidos globalmente
- **Load Balancing** - Distribuci√≥n de tr√°fico
- **Auto-scaling** - Escalado autom√°tico de recursos

---

## üõ°Ô∏è DISASTER RECOVERY

### **Backup Strategy**
- **Database Backups** - Daily automated backups
- **Point-in-time Recovery** - Supabase PITR
- **File Backups** - Storage replication
- **Configuration Backups** - Infrastructure as Code

### **Monitoring & Alerting**
- **Uptime Monitoring** - 24/7 availability checks
- **Error Tracking** - Real-time error notifications
- **Performance Monitoring** - Response time tracking
- **Business Metrics** - KPI monitoring

---

Esta arquitectura proporciona una base s√≥lida, escalable y mantenible para el crecimiento de PODENZA, con patrones claros para la extensi√≥n de funcionalidades y integraci√≥n de nuevos servicios.